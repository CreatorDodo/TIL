# Temporary Smart Wallets (EIP-7702)

## 스마트 월렛 채택의 높은 진입 장벽

Account Abstraction과 스마트 컨트랙트 월렛은 더 사용자 친화적이고 강력한 Web3를 약속해왔습니다. 여러 액션을 단일 트랜잭션으로 묶거나 다중 서명을 통한 보안 강화 등 표준 월렛 대비 상당한 업그레이드를 제공합니다.

그러나 **마이그레이션**이라는 큰 장벽이 채택을 늦추고 있습니다.

### 기존 EOA 사용자의 마이그레이션 문제

스마트 월렛을 사용하려면 기존 EOA(Externally Owned Account, 예: MetaMask 월렛) 사용자는 단순히 업그레이드할 수 없고, 완전히 새로운 스마트 월렛 계정을 생성해야 합니다.

이 과정에서 발생하는 문제:

- 완전히 새로운 월렛 주소를 받아야 함
- 새로운 UI를 학습해야 함
- 모든 자금, NFT, 기타 자산을 수동으로 이전해야 함

---

## EIP-7702: 월렛의 임시 슈퍼파워

EIP-7702는 이 문제에 대한 우아한 솔루션을 제시합니다.

> 사용자를 강제로 마이그레이션하는 대신, **EOA가 단일 트랜잭션 동안 스마트 컨트랙트의 기능을 임시로 "빌릴" 수 있게** 합니다.

### 핵심 개념

- 일반 MetaMask 월렛이 **필요할 때만** 스마트 월렛처럼 동작
- 하나의 트랜잭션에서 고급 기능을 얻고, 직후에 표준 EOA로 복귀
- **주소 변경, 자금 이전, 새 인터페이스 학습 없이** 강력한 기능 접근 가능

---

## EIP-7702 작동 방식: Delegation의 힘

EIP-7702를 가능하게 하는 메커니즘은 **Delegation(위임)**입니다.

### 일반 트랜잭션 vs EIP-7702 트랜잭션

| 일반 트랜잭션                  | EIP-7702 트랜잭션           |
| ------------------------------ | --------------------------- |
| 사용자가 메시지 서명           | 특수 트랜잭션 서명          |
| 프로토콜 규칙에 따라 직접 실행 | 스마트 컨트랙트에 실행 위임 |

### 단계별 프로세스

1. **트랜잭션 전**: 월렛은 일반 EOA로 기능
2. **트랜잭션 서명**: "이 스마트 컨트랙트의 코드를 사용해 다음 트랜잭션을 실행하겠다"는 특수 메시지 서명
3. **트랜잭션 중**: EOA가 위임된 스마트 컨트랙트의 "슈퍼파워"를 임시로 획득 (배치 액션, 다양한 가스 지불 방식 등)
4. **트랜잭션 후**: 월렛이 일반 EOA 상태로 복귀

---

## 실제 사용 사례: 트랜잭션 배칭

### 시나리오: 토큰 스왑 + ETH 전송

#### 기존 방식 (표준 EOA)

ETH를 USDC로 스왑하고 친구에게 ETH를 보내려면 **3개의 개별 트랜잭션**이 필요:

1. **Transaction 1**: DEX가 ETH를 사용할 수 있도록 Approve
2. **Transaction 2**: ETH → USDC 스왑 실행
3. **Transaction 3**: 친구에게 ETH 전송

**결과**: 3번의 클릭, 3개의 월렛 팝업, 3개의 가스비 → 느리고, 비싸고, 불편함

#### 새로운 방식 (EIP-7702)

동일한 EOA에서 "batch transaction" 스마트 컨트랙트에 위임:

1. **Single Transaction**: approve, swap, send 세 가지 액션 모두 포함한 EIP-7702 트랜잭션 서명

**결과**: 1번의 클릭, 1개의 팝업, 1개의 가스비 → 빠르고, 저렴하고, 직관적

---

## 기술적 세부사항: 새로운 Type 4 트랜잭션

EIP-7702는 프로토콜 레벨에서 새로운 트랜잭션 타입을 도입합니다.

### Ethereum 트랜잭션 타입 변천사

| Type       | EIP      | 설명                                                                   |
| ---------- | -------- | ---------------------------------------------------------------------- |
| **Type 0** | -        | 원래의 레거시 트랜잭션 포맷                                            |
| **Type 1** | EIP-2930 | 가스 비용 최적화를 위한 "access lists" 지원 추가                       |
| **Type 2** | EIP-1559 | 예측 가능한 가스 가격을 위한 base fee + priority fee 모델              |
| **Type 3** | EIP-4844 | Layer 2 데이터를 저렴하게 이더리움에 게시하기 위한 "Blob transactions" |
| **Type 4** | EIP-7702 | EOA가 트랜잭션 내 스마트 컨트랙트 코드에 실행을 위임할 수 있게 함      |

---

## MetaMask에서 EIP-7702 활성화 방법

MetaMask는 이미 이 기능을 통합했으며, 사용자 안전과 단순성을 위해 기본 복잡성을 추상화했습니다.

### 보안 조치

- 임의의 컨트랙트에 위임하는 것을 **허용하지 않음** (악성 스마트 컨트랙트 방지)
- MetaMask의 **사전 구축, 감사 완료, 하드코딩된 스마트 컨트랙트**만 사용
- 배칭, 유연한 가스 지불 등의 기능을 "Smart Transactions"로 제공

### 활성화 단계

1. MetaMask 확장 프로그램을 최신 버전으로 업데이트
2. MetaMask 확장 프로그램을 열고 우측 상단 메뉴 아이콘(세 줄) 클릭
3. **Settings** (톱니바퀴 아이콘) 선택
4. **Advanced** 탭 선택
5. **Smart Transactions** 옵션 찾기
6. 스위치를 **ON** 위치로 토글

활성화하면 MetaMask가 적절한 상황에서 자동으로 이 기능을 사용하여 더 적은 팝업과 효율적인 트랜잭션을 제공합니다.

---

## 결론

EIP-7702는 대규모 기존 EOA 생태계와 완전한 Account Abstraction의 미래 사이의 **핵심 브릿지** 역할을 합니다.

### 주요 의의

- 마이그레이션 마찰 없이 수백만 사용자가 즉시 스마트 월렛의 혜택을 경험 가능
- 고급 블록체인 기능을 더 접근하기 쉽고 사용자 친화적으로 만듦
- 더 넓은 채택과 크게 개선된 Web3 사용자 경험을 위한 길을 개척

---

## References

- [EIP-7702 Specification](https://eips.ethereum.org/EIPS/eip-7702)
- [MetaMask Smart Transactions](https://metamask.io/)
