# Layer 1, Layer 2, 그리고 Rollup 스케일링 솔루션

## 개요: 블록체인 트릴레마

이더리움과 같은 기반 블록체인은 **블록체인 트릴레마(Blockchain Trilemma)**라는 핵심 과제에 직면해 있습니다.

> 블록체인은 **탈중앙화(Decentralization)**, **보안(Security)**, **확장성(Scalability)** 세 가지 속성 중 두 가지만 최적화할 수 있다는 개념

이더리움은 **탈중앙화**와 **보안**을 우선시하도록 설계되어 가장 견고하고 신뢰할 수 있는 스마트 컨트랙트 플랫폼이 되었습니다. 그러나 이로 인해 **확장성**이 제한되어 초당 약 15개의 트랜잭션만 처리할 수 있습니다.

수요가 높을 때 이러한 제한은 네트워크 혼잡과 과도하게 비싼 트랜잭션 수수료(가스비)로 이어집니다.

---

## Layer 1 (L1) 블록체인이란?

**Layer 1(L1)**은 블록체인 생태계의 **기본 프로토콜**입니다.

### 핵심 특징

- 자체 보안을 유지하고 원장 상태에 대한 합의를 도출하는 책임
- 독립적으로 운영되며 최종성(finality)이나 보안을 위해 다른 네트워크에 의존하지 않음
- 모든 트랜잭션이 최종적으로 확정되는 **궁극적인 진실의 원천**
- **정산 레이어(Settlement Layer)**라고도 불림

### L1 블록체인 예시

| 블록체인             | 설명                                            |
| -------------------- | ----------------------------------------------- |
| **Ethereum Mainnet** | 대표적인 스마트 컨트랙트 플랫폼                 |
| **Bitcoin**          | 최초의 블록체인                                 |
| **Solana**           | 고성능 L1                                       |
| **BNB Chain**        | 바이낸스 기반 체인                              |
| **Sepolia**          | 이더리움 테스트넷 (테스트 환경에서 L1으로 기능) |

---

## Layer 2 (L2) 블록체인이란?

**Layer 2(L2)**는 Layer 1 위에 구축된 **별도의 블록체인 프로토콜**입니다.

### 핵심 목적

- L1의 기능을 확장하여 **확장성 개선**
- 자체 체인에서 트랜잭션을 처리하지만 L1에 "연결"
- 상위 레이어의 **보안**과 **탈중앙화**를 상속

### L2 vs dApp

| 구분     | 설명                                                |
| -------- | --------------------------------------------------- |
| **dApp** | L1 블록체인에 배포된 프로그램 (예: Uniswap)         |
| **L2**   | L1을 보완하도록 설계된 **별도의 블록체인 네트워크** |

### L2 블록체인 예시

- **ZKsync**
- **Optimism (OP)**
- **Arbitrum**
- **Polygon**

---

## Rollups: 주요 L2 스케일링 솔루션

**Rollup**은 가장 널리 채택된 L2 스케일링 솔루션입니다.

### 작동 방식

```
L2에서 트랜잭션 실행 → 수백 개의 트랜잭션을 하나의 배치로 "롤업" → L1에 압축된 배치 게시
```

### 장점

- **처리량 증가**: 드라마틱한 트랜잭션 처리량 향상
- **비용 절감**: L1에 배치를 게시하는 가스비를 포함된 모든 트랜잭션이 공유
- 개별 트랜잭션 비용이 L1에서 직접 처리하는 것보다 **훨씬 저렴**

---

## Rollup의 두 가지 유형

### 1. Optimistic Rollups

배치의 모든 트랜잭션이 기본적으로 유효하다는 **"낙관적"** 가정으로 운영됩니다.

#### 작동 과정

1. L2 운영자가 L1에 배치 게시
2. **챌린지 기간(Challenge Period)** 시작 (보통 약 1주일)
3. 이 기간 동안 다른 네트워크 참여자가 배치를 검토 가능
4. 무효한 트랜잭션 발견 시 **사기 증명(Fraud Proof)** 제출

#### 결과

| 시나리오                            | 결과                                                    |
| ----------------------------------- | ------------------------------------------------------- |
| 사기 증명 성공                      | 부정 배치 되돌림 + 악의적 운영자의 스테이킹 담보 슬래싱 |
| 챌린지 기간 종료 (성공적 이의 없음) | 배치가 최종 확정되어 L1에 영구 기록                     |

#### 트레이드오프

⚠️ 트랜잭션 최종성까지 **긴 대기 시간** 필요  
⚠️ L2에서 L1으로 자금 인출 시 챌린지 기간 종료까지 대기 필요

---

### 2. Zero-Knowledge (ZK) Rollups

유효성을 가정하고 이의를 기다리는 대신, **고급 암호학**을 사용하여 모든 트랜잭션 배치의 유효성을 **사전에 증명**합니다.

#### 작동 과정

1. ZK-Rollup 운영자가 L1에 배치 제출
2. 동시에 **유효성 증명(Validity Proof)**, 즉 **영지식 증명(Zero-Knowledge Proof, ZKP)** 생성 및 제출
3. 이 증명이 배치 내 모든 상태 변경이 올바르고 네트워크 규칙을 따른다는 것을 **수학적으로 보장**
4. L1의 **검증자(Verifier)** 스마트 컨트랙트가 즉시 증명 확인
5. 증명이 유효하면 배치가 **즉시 수락 및 확정**

#### 장점

✅ 긴 챌린지 기간 불필요  
✅ Optimistic Rollups 대비 **훨씬 빠른 인출 및 최종성**

#### 핵심 특성: 간결성 (Succinctness)

- 증명이 **매우 작고 빠르게 검증** 가능
- 막대한 연산을 나타내더라도 효율적으로 검증
- 이러한 이유로 **Succinct Rollups**라고도 불림

#### ZK-ZK Rollups

일부 ZK-Rollups는 "영지식" 속성을 활용하여 **프라이버시 기능**을 제공합니다:

- 비밀 잔액
- 기밀 트랜잭션
- 대표 예시: **Aztec**

---

## 비교 요약

| 특성            | Optimistic Rollups      | ZK Rollups                   |
| --------------- | ----------------------- | ---------------------------- |
| **유효성 검증** | 사기 증명 (Fraud Proof) | 유효성 증명 (Validity Proof) |
| **최종성**      | 챌린지 기간 후 (~1주일) | 즉시                         |
| **인출 시간**   | 느림                    | 빠름                         |
| **기술 복잡도** | 상대적으로 낮음         | 높음 (고급 암호학)           |
| **예시**        | Optimism, Arbitrum      | ZKsync, Polygon zkEVM        |

---

## 결론

- **Layer 1 블록체인** (예: 이더리움): 탁월한 보안과 탈중앙화를 제공하지만 확장성에 한계
- **Layer 2 솔루션**, 특히 **Rollups**: 별도의 빠른 레이어에서 트랜잭션을 처리하면서 L1의 보안을 상속하여 문제 해결
  - **Optimistic Rollups**: 시간 지연이 있는 사기 증명 시스템
  - **ZK-Rollups**: 즉각적인 최종성을 위한 암호학적 유효성 증명

이러한 기술들이 함께 이더리움 생태계의 확장을 가능하게 하여 **대중 채택의 길**을 열고 있습니다.
